<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Secure File Storage Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/feather-icons"></script>
</head>
<body class="bg-gradient-to-r from-purple-400 via-pink-300 to-yellow-200 min-h-screen flex flex-col">

    <div class="max-w-4xl mx-auto py-12 px-6">
    <h1 class="text-4xl font-extrabold text-gray-900 text-center mb-12">üîê Secure File Storage Dashboard</h1>

    <!-- Message -->
    {% if message %}
      <p class="text-green-700 text-center text-lg font-medium mb-6">{{ message }}</p>
    {% endif %}

    <!-- Step 1: Upload & Encrypt -->
    <div class="bg-white rounded-3xl shadow-2xl p-6 mb-6 hover:scale-105 transform transition duration-300">
      <h2 class="text-2xl font-semibold mb-4 flex items-center gap-2">
        <i data-feather="file-text"></i> Step 1: Upload & Encrypt
      </h2>
      <form action="/data" method="POST" enctype="multipart/form-data" class="flex flex-col items-center gap-4">
        <input type="file" name="file" required class="border border-gray-300 rounded-md p-2 w-full"/>
        <button class="bg-indigo-600 text-white font-semibold py-2 px-6 rounded-xl shadow hover:bg-indigo-700 hover:scale-105 transform transition duration-300">
          Encrypt File
        </button>
      </form>
      {% if uploaded_files %}
        <div class="mt-4 text-left">
          <strong>Uploaded File:</strong>
          <ul class="list-disc pl-5 mt-2">
            {% for f in uploaded_files %}
              <li>{{ f }}</li>
            {% endfor %}
          </ul>
        </div>
      {% endif %}
    </div>

    <!-- Step 2: Download Private Key -->
    {% if key_filename %}
    <div class="bg-white rounded-3xl shadow-2xl p-6 mb-6 hover:scale-105 transform transition duration-300">
      <h2 class="text-2xl font-semibold mb-4 flex items-center gap-2">
        <i data-feather="key"></i> Step 2: Download Your Private Key
      </h2>
      <a href="/return-key/{{ key_filename }}" target="_blank">
        <button class="bg-green-600 text-white font-semibold py-2 px-6 rounded-xl shadow hover:bg-green-700 hover:scale-105 transform transition duration-300">
          Download Key
        </button>
      </a>
    </div>
    {% endif %}

    <!-- Step 3: Upload Key & Decrypt -->
    <div class="bg-white rounded-3xl shadow-2xl p-6 mb-6 hover:scale-105 transform transition duration-300">
      <h2 class="text-2xl font-semibold mb-4 flex items-center gap-2">
        <i data-feather="unlock"></i> Step 3: Upload Key & Decrypt
      </h2>
      <form action="/download_data" method="POST" enctype="multipart/form-data" class="flex flex-col items-center gap-4">
        <input type="file" name="file" required class="border border-gray-300 rounded-md p-2 w-full"/>
        <button class="bg-yellow-600 text-white font-semibold py-2 px-6 rounded-xl shadow hover:bg-yellow-700 hover:scale-105 transform transition duration-300">
          Decrypt File
        </button>
      </form>
    </div>

    <!-- Step 4: Download Restored File -->
    {% if restored_filename %}
    <div class="bg-white rounded-3xl shadow-2xl p-6 mb-6 hover:scale-105 transform transition duration-300">
      <h2 class="text-2xl font-semibold mb-4 flex items-center gap-2">
        <i data-feather="download"></i> Step 4: Download Restored File
      </h2>
      <a href="/return-file/" target="_blank">
        <button class="bg-purple-600 text-white font-semibold py-2 px-6 rounded-xl shadow hover:bg-purple-700 hover:scale-105 transform transition duration-300">
          Download Restored File
        </button>
      </a>
      <div class="mt-4 text-left">
        <strong>Restored File:</strong>
        <ul class="list-disc pl-5 mt-2">
          <li>{{ restored_filename }}</li>
        </ul>
      </div>
    </div>
    {% endif %}

    <!-- Footer -->
    <div class="text-center mt-10 text-gray-700">
      <h4 class="font-semibold">Project by:</h4>
      <p>Sagar R S<br>MCA (Dept of CS&E)<br>USN- 4VZ23MC094</p>
    </div>
  </div>

  <!-- Auto-scroll -->
  <script>
    window.onload = function() {
      const msg = "{{ message|default('') }}";
      if (msg.includes("encrypted")) {
        const step2 = document.getElementById("step2");
        if (step2) step2.scrollIntoView({behavior: "smooth"});
      } else if (msg.includes("decrypted")) {
        const step4 = document.getElementById("step4");
        if (step4) step4.scrollIntoView({behavior: "smooth"});
      }
    }
  </script>

  <!-- Feather Icons -->
  <script>
    feather.replace()
  </script>

</body>
</html>
